{% extends "base.html" %}

{% block content %}


<div class="col-xl-12">
    <div class="card">
        <div class="card-body">
            <div class="col-lg-12 text-right">
                <a href="" class="btn btn-warning active waves-effect waves-light">
                    Add Action
                </a>
                </div>
                <br>
            <h4 class="card-title">ACTIONS</h4>
            <br>

            <ul class="nav nav-tabs nav-justified mb-3">
                <li class="nav-item">
                    <a href="#manual" data-toggle="tab" aria-expanded="true" class="nav-link active">
                        <i class="mdi mdi-home-variant d-lg-none d-block"></i>
                        <!-- Display the count of manual actions that are not completed -->
                        <span class="d-none d-lg-block">Manual Actions 
                          <span class="badge badge-danger badge-pill">{{ manual_not_completed_count }}</span></span>                            
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#automatic" data-toggle="tab" aria-expanded="false" class="nav-link ">
                        <i class="mdi mdi-account-circle d-lg-none d-block"></i>
                        <span class="d-none d-lg-block">Automatic Actions <span class="badge badge-danger badge-pill">{{ auto_count }}</span></span></span>
                        
                    </a>
                </li>
                <li class="nav-item">
                    <a href="#allaction" data-toggle="tab" aria-expanded="false" class="nav-link ">
                        <i class="mdi mdi-account-circle d-lg-none d-block"></i>
                        <span class="d-none d-lg-block">Action History </span>
                        
                    </a>
                </li>
            </ul>
        
    <div class="tab-content">
        <div class="tab-pane show active" id="manual">
            <div class="row">
                <div class="col-12">
                        <div class="card-body">
                            
                          <form method="post" action="{% url 'collection' %}">
                            {% csrf_token %}
                            <table id="basic-datatable" class="table">
                                <thead>
                                    <tr>
                                        <th>Completed</th>
                                        <th>Action Date</th>
                                        <th>Action Type</th>
                                        <th>Action Amount</th>
                                        <th>Client ID</th>
                                        <th>Client Name</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {% for action in actions %}
                                    {% if not action.completed and action.type == 'manual' %}
                                    <tr style="background-color: #f2dede;">
                                        <td class="text-center" style="width: 10px;">
                                            <input type="checkbox" name="completed_actions" value="{{ action.id }}">
                                        </td>
                                        <td>{{ action.action_date }}</td>
                                        {% if action.action_type == 'SMS' %}
                                        <td>
                                            <button type="button" class="btn btn-warning waves-effect waves-light" style="width: 150px;">
                                                <i class="mdi mdi-message"></i> {{ action.action_type }}
                                            </button>
                                        </td>
                                        {% elif action.action_type == 'Call' %}
                                        <td>
                                            <button type="button" class="btn btn-success waves-effect waves-light" style="width: 150px;">
                                                <i class="mdi mdi-phone"></i> {{ action.action_type }}
                                            </button>
                                        </td>
                                        {% elif action.action_type == 'Email' %}
                                        <td>
                                            <button type="button" class="btn btn-danger waves-effect waves-light" style="width: 150px;">
                                                <i class="mdi mdi-gmail"></i> {{ action.action_type }}
                                            </button>
                                        </td>
                                        {% endif %}
                                        <td>Rs {{ action.action_amount }}</td>
                                        <td>{{ action.short_name.short_name }}</td>
                                        <td><a href="{% url 'client_profile' client_id=action.short_name.id %}">{{ action.short_name }}</a></td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}
                                </tbody>
                            </table>
                            {% if manual_not_completed_count > 0 %}
                            <button type="submit" class="btn btn-success btn-sm waves-effect waves-light">Complete Actions</button>
                            {% endif %}
                        </form>
                        
                              
                        </div> <!-- end card body-->
                 
                </div><!-- end col-->
            </div>
            <!-- end row-->
        
        </div>
        <div class="tab-pane " id="automatic">
            <div class="row">
                <div class="col-12">
                        <div class="card-body">
                            
                            
                                <table id="basic-datatable" class="table">
                                  <thead>
                                    <tr>
                                      
                                      <th>Action Date</th>
                                      <th>Action Type</th>
                                      <th>Action Amount</th>
                                      <th>Client ID</th>
                                      <th>Client Name</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    {% for action in actions %}
                                    {% if action.type == 'auto'  %}
                                    <tr style="{% if action.completed %}background-color: #dff0d8;
                                    {% elif not action.completed %}background-color: #fcf8e3;{% endif %}">
                                      
                                      <td>{{ action.action_date }}</td>
                                      {% if action.action_type == 'SMS' %}
                                      <td>
                                        <button type="button" class="btn btn-warning waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-message"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% elif action.action_type == 'Call' %}
                                      <td>
                                        <button type="button" class="btn btn-success waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-phone"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% elif action.action_type == 'Email' %}
                                      <td>
                                        <button type="button" class="btn btn-danger waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-gmail"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% endif %}
                                      <td>Rs {{ action.action_amount }}</td>
                                      <td>{{ action.short_name.short_name }}</td>
                                      <td><a href="{% url 'client_profile' client_id=action.short_name.id %}">{{ action.short_name }}</a></td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}
                                  </tbody>
                                </table>
                              
                              
                        </div> <!-- end card body-->
                 
                </div><!-- end col-->
            </div>
            <!-- end row-->
        </div>
        <div class="tab-pane" id="allaction">
            <div class="row">
                <div class="col-12">
                        <div class="card-body">
                            
                            
                                <table id="basic-datatable" class="table">
                                  <thead>
                                    <tr>
                                      
                                      <th>Action Date</th>
                                      <th>Action Type</th>
                                      <th>Action Amount</th>
                                      <th>Client ID</th>
                                      <th>Client Name</th>
                                    </tr>
                                  </thead>
                                  <tbody>
                                    {% for action in actions %}
                                    {% if action.completed %}
                                    <tr style="background:#dff0d8">
                                     
                                      <td>{{ action.action_date }}</td>
                                      {% if action.action_type == 'SMS' %}
                                      <td>
                                        <button type="button" class="btn btn-warning waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-message"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% elif action.action_type == 'Call' %}
                                      <td>
                                        <button type="button" class="btn btn-success waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-phone"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% elif action.action_type == 'Email' %}
                                      <td>
                                        <button type="button" class="btn btn-danger waves-effect waves-light" style="width: 150px;">
                                          <i class="mdi mdi-gmail"></i> {{ action.action_type }}
                                        </button>
                                      </td>
                                      {% endif %}
                                      <td>Rs {{ action.action_amount }}</td>
                                      <td>{{ action.short_name.short_name }}</td>
                                      <td><a href="{% url 'client_profile' client_id=action.short_name.id %}">{{ action.short_name }}</a></td>
                                    </tr>
                                    {% endif %}
                                    {% endfor %}
                                  </tbody>
                                </table>
                                
                              
                        </div> <!-- end card body-->
                 
                </div><!-- end col-->
            </div>
            <!-- end row-->
        </div>
    </div>
        </div> <!-- end card-body-->
    </div> <!-- end card-->
</div> <!-- end col -->

<!-- end row-->
{% endblock content %}